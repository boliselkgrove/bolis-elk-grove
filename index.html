<!DOCTYPE html> 
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bolis Pickup Orders</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script type="text/javascript">
    (function(){
      emailjs.init("jNjnwDTehjtDEem4i");
    })();
  </script>
</head>
<body class="bg-gradient-to-br from-pink-200 via-yellow-100 to-blue-200 min-h-screen flex flex-col items-center p-6">
  <h1 class="text-4xl font-bold mb-6 text-pink-600">üçß Bolis Pickup Orders</h1>

  <form id="orderForm" class="bg-white shadow-lg rounded-2xl p-6 w-full max-w-xl">
    <label class="block mb-2 font-semibold">Your Name</label>
    <input type="text" id="customerName" required class="w-full p-2 mb-4 border rounded">

    <label class="block mb-2 font-semibold">Your Email</label>
    <input type="email" id="customerEmail" required class="w-full p-2 mb-4 border rounded">

    <label class="block mb-2 font-semibold">Flavors (select quantities)</label>
    <div id="flavors" class="grid grid-cols-2 gap-2 mb-4">
      <div><label>Oreo</label><input type="number" min="0" value="0" data-flavor="Oreo" class="flavor w-full p-1 border rounded"></div>
      <div><label>Nutella</label><input type="number" min="0" value="0" data-flavor="Nutella" class="flavor w-full p-1 border rounded"></div>
      <div><label>Mango Chili</label><input type="number" min="0" value="0" data-flavor="Mango Chili" class="flavor w-full p-1 border rounded"></div>
      <div><label>Mango</label><input type="number" min="0" value="0" data-flavor="Mango" class="flavor w-full p-1 border rounded"></div>
      <div><label>Strawberry</label><input type="number" min="0" value="0" data-flavor="Strawberry" class="flavor w-full p-1 border rounded"></div>
      <div><label>Strawberries & Cream</label><input type="number" min="0" value="0" data-flavor="Strawberries & Cream" class="flavor w-full p-1 border rounded"></div>
      <div><label>Coconut</label><input type="number" min="0" value="0" data-flavor="Coconut" class="flavor w-full p-1 border rounded"></div>
      <div><label>Gansito</label><input type="number" min="0" value="0" data-flavor="Gansito" class="flavor w-full p-1 border rounded"></div>
      <div><label>Mazap√°n</label><input type="number" min="0" value="0" data-flavor="Mazap√°n" class="flavor w-full p-1 border rounded"></div>
    </div>

    <label class="block mb-2 font-semibold">Payment Method</label>
    <select id="paymentMethod" class="w-full p-2 mb-4 border rounded">
      <option value="Apple Pay">Apple Pay</option>
      <option value="Cash on Pickup">Cash on Pickup</option>
    </select>

    <button type="submit" class="w-full bg-pink-500 hover:bg-pink-600 text-white p-3 rounded-xl font-bold">Place Order</button>
  </form>

  <script>
    function calculateTotal(orderCounts) {
      let totalBolis = Object.values(orderCounts).reduce((a,b) => a+b, 0);
      let total = 0;
      if(totalBolis >= 100) {
        total = 200 * Math.floor(totalBolis/100);
        totalBolis = totalBolis % 100;
      }
      if(totalBolis >= 48) {
        total += 104 * Math.floor(totalBolis/48);
        totalBolis = totalBolis % 48;
      }
      if(totalBolis >= 36) {
        total += 84 * Math.floor(totalBolis/36);
        totalBolis = totalBolis % 36;
      }
      if(totalBolis >= 24) {
        total += 60 * Math.floor(totalBolis/24);
        totalBolis = totalBolis % 24;
      }
      if(totalBolis >= 12) {
        total += 32 * Math.floor(totalBolis/12);
        totalBolis = totalBolis % 12;
      }
      total += totalBolis * 3;
      return total;
    }

    document.getElementById("orderForm").addEventListener("submit", function(e){
      e.preventDefault();
      let name = document.getElementById("customerName").value;
      let email = document.getElementById("customerEmail").value;
      let payment = document.getElementById("paymentMethod").value;
      let flavors = document.querySelectorAll(".flavor");
      let orderCounts = {};
      let summary = "";
      flavors.forEach(f => {
        let qty = parseInt(f.value) || 0;
        if(qty > 0){
          orderCounts[f.dataset.flavor] = qty;
          summary += f.dataset.flavor + ": " + qty + "\n";
        }
      });
      let total = calculateTotal(orderCounts);

      let templateParamsOwner = {
        customer_name: name,
        customer_email: email,
        order_summary: summary,
        order_total: total,
        payment_method: payment
      };
      let templateParamsCustomer = templateParamsOwner;

      // Send to owner
      emailjs.send("service_os7de1n","template_5plcqxe",templateParamsOwner)
        .then(() => {
          console.log("Owner email sent");
        }, (error) => {
          console.error("Owner email failed", error);
        });

      // Send to customer
      emailjs.send("service_os7de1n","template_se19j7c",templateParamsCustomer)
        .then(() => {
          alert("Order placed successfully! Confirmation sent to your email.");
        }, (error) => {
          console.error("Customer email failed", error);
        });

    });
  </script>
</body>
</html>
